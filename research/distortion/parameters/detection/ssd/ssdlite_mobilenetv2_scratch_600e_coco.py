from research.distortion.parameters.block_sizes import BLOCK_SIZES_256x256, BLOCK_SIZES_128x128, BLOCK_SIZES_64x64, \
    BLOCK_SIZES_1x1


class MobileNetV2:
    def __init__(self):
        self.BLOCK_NAMES = \
            [
                "conv1",
                "layer1_0",
                "layer2_0",
                "layer2_1",
                "layer3_0",
                "layer3_1",
                "layer3_2",
                "layer4_0",
                "layer4_1",
                "layer4_2",
                "layer4_3",
                "layer5_0",
                "layer5_1",
                "layer5_2",
                "layer6_0",
                "layer6_1",
                "layer6_2",
                "layer7_0",
                "conv2",
                "extra_layer_0",
                "extra_layer_1",
                "extra_layer_2",
                "extra_layer_3",
                None
            ]

        self.LAYER_NAME_TO_BLOCK_NAME = \
            {
                'conv1': 'conv1',
                'layer1_0_0': 'layer1_0',
                'layer2_0_0': 'layer2_0',
                'layer2_0_1': 'layer2_0',
                'layer2_1_0': 'layer2_1',
                'layer2_1_1': 'layer2_1',
                'layer3_0_0': 'layer3_0',
                'layer3_0_1': 'layer3_0',
                'layer3_1_0': 'layer3_1',
                'layer3_1_1': 'layer3_1',
                'layer3_2_0': 'layer3_2',
                'layer3_2_1': 'layer3_2',
                'layer4_0_0': 'layer4_0',
                'layer4_0_1': 'layer4_0',
                'layer4_1_0': 'layer4_1',
                'layer4_1_1': 'layer4_1',
                'layer4_2_0': 'layer4_2',
                'layer4_2_1': 'layer4_2',
                'layer4_3_0': 'layer4_3',
                'layer4_3_1': 'layer4_3',
                'layer5_0_0': 'layer5_0',
                'layer5_0_1': 'layer5_0',
                'layer5_1_0': 'layer5_1',
                'layer5_1_1': 'layer5_1',
                'layer5_2_0': 'layer5_2',
                'layer5_2_1': 'layer5_2',
                'layer6_0_0': 'layer6_0',
                'layer6_0_1': 'layer6_0',
                'layer6_1_0': 'layer6_1',
                'layer6_1_1': 'layer6_1',
                'layer6_2_0': 'layer6_2',
                'layer6_2_1': 'layer6_2',
                'layer7_0_0': 'layer7_0',
                'layer7_0_1': 'layer7_0',
                'conv2': 'conv2',
                "extra_layer_0_conv": "extra_layer_0",
                "extra_layer_0_separable_depthwise": "extra_layer_0",
                "extra_layer_0_separable_pointwise": "extra_layer_0",
                "extra_layer_1_conv": "extra_layer_1",
                "extra_layer_1_separable_depthwise": "extra_layer_1",
                "extra_layer_1_separable_pointwise": "extra_layer_1",
                "extra_layer_2_conv": "extra_layer_2",
                "extra_layer_2_separable_depthwise": "extra_layer_2",
                "extra_layer_2_separable_pointwise": "extra_layer_2",
                "extra_layer_3_conv": "extra_layer_3",
                "extra_layer_3_separable_depthwise": "extra_layer_3",
                "extra_layer_3_separable_pointwise": "extra_layer_3",
            }

        self.LAYER_NAMES = \
            [
                "conv1",
                "layer1_0_0",
                "layer2_0_0",
                "layer2_0_1",
                "layer2_1_0",
                "layer2_1_1",
                "layer3_0_0",
                "layer3_0_1",
                "layer3_1_0",
                "layer3_1_1",
                "layer3_2_0",
                "layer3_2_1",
                "layer4_0_0",
                "layer4_0_1",
                "layer4_1_0",
                "layer4_1_1",
                "layer4_2_0",
                "layer4_2_1",
                "layer4_3_0",
                "layer4_3_1",
                "layer5_0_0",
                "layer5_0_1",
                "layer5_1_0",
                "layer5_1_1",
                "layer5_2_0",
                "layer5_2_1",
                "layer6_0_0",
                "layer6_0_1",
                "layer6_1_0",
                "layer6_1_1",
                "layer6_2_0",
                "layer6_2_1",
                "layer7_0_0",
                "layer7_0_1",
                "conv2",
                "extra_layer_0_conv",
                "extra_layer_0_separable_depthwise",
                "extra_layer_0_separable_pointwise",
                "extra_layer_1_conv",
                "extra_layer_1_separable_depthwise",
                "extra_layer_1_separable_pointwise",
                "extra_layer_2_conv",
                "extra_layer_2_separable_depthwise",
                "extra_layer_2_separable_pointwise",
                "extra_layer_3_conv",
                "extra_layer_3_separable_depthwise",
                "extra_layer_3_separable_pointwise",
            ]

        self.BLOCK_INPUT_DICT = \
            {
                "conv1": "input_images",
                "layer1_0": "conv1",
                "layer2_0": "layer1_0",
                "layer2_1": "layer2_0",
                "layer3_0": "layer2_1",
                "layer3_1": "layer3_0",
                "layer3_2": "layer3_1",
                "layer4_0": "layer3_2",
                "layer4_1": "layer4_0",
                "layer4_2": "layer4_1",
                "layer4_3": "layer4_2",
                "layer5_0": "layer4_3",
                "layer5_1": "layer5_0",
                "layer5_2": "layer5_1",
                "layer6_0": "layer5_2",
                "layer6_1": "layer6_0",
                "layer6_2": "layer6_1",
                "layer7_0": "layer6_2",
                "conv2": "layer7_0",
                "extra_layer_0": "conv2",
                "extra_layer_1": "extra_layer_0",
                "extra_layer_2": "extra_layer_1",
                "extra_layer_3": "extra_layer_2",
                None: "extra_layer_3"
            }

        self.LAYER_NAME_TO_BLOCK_SIZES = \
            {
                'conv1': BLOCK_SIZES_160x160,
                'layer1_0_0': BLOCK_SIZES_160x160,
                'layer2_0_0': BLOCK_SIZES_160x160,
                'layer2_0_1': BLOCK_SIZES_80x80,
                'layer2_1_0': BLOCK_SIZES_80x80,
                'layer2_1_1': BLOCK_SIZES_80x80,
                'layer3_0_0': BLOCK_SIZES_80x80,
                'layer3_0_1': BLOCK_SIZES_40x40,
                'layer3_1_0': BLOCK_SIZES_40x40,
                'layer3_1_1': BLOCK_SIZES_40x40,
                'layer3_2_0': BLOCK_SIZES_40x40,
                'layer3_2_1': BLOCK_SIZES_40x40,
                'layer4_0_0': BLOCK_SIZES_40x40,
                'layer4_0_1': BLOCK_SIZES_20x20,
                'layer4_1_0': BLOCK_SIZES_20x20,
                'layer4_1_1': BLOCK_SIZES_20x20,
                'layer4_2_0': BLOCK_SIZES_20x20,
                'layer4_2_1': BLOCK_SIZES_20x20,
                'layer4_3_0': BLOCK_SIZES_20x20,
                'layer4_3_1': BLOCK_SIZES_20x20,
                'layer5_0_0': BLOCK_SIZES_20x20,
                'layer5_0_1': BLOCK_SIZES_20x20,
                'layer5_1_0': BLOCK_SIZES_20x20,
                'layer5_1_1': BLOCK_SIZES_20x20,
                'layer5_2_0': BLOCK_SIZES_20x20,
                'layer5_2_1': BLOCK_SIZES_20x20,
                'layer6_0_0': BLOCK_SIZES_20x20,
                'layer6_0_1': BLOCK_SIZES_10x10,
                'layer6_1_0': BLOCK_SIZES_10x10,
                'layer6_1_1': BLOCK_SIZES_10x10,
                'layer6_2_0': BLOCK_SIZES_10x10,
                'layer6_2_1': BLOCK_SIZES_10x10,
                'layer7_0_0': BLOCK_SIZES_10x10,
                'layer7_0_1': BLOCK_SIZES_10x10,
                'conv2': BLOCK_SIZES_10x10,
                'extra_layer_0_conv': BLOCK_SIZES_10x10,
                'extra_layer_0_separable_depthwise': BLOCK_SIZES_5x5,
                'extra_layer_0_separable_pointwise': BLOCK_SIZES_5x5,
                'extra_layer_1_conv': BLOCK_SIZES_5x5,
                'extra_layer_1_separable_depthwise': BLOCK_SIZES_3x3,
                'extra_layer_1_separable_pointwise': BLOCK_SIZES_3x3,
                'extra_layer_2_conv': BLOCK_SIZES_3x3,
                'extra_layer_2_separable_depthwise': BLOCK_SIZES_2x2,
                'extra_layer_2_separable_pointwise': BLOCK_SIZES_2x2,
                'extra_layer_3_conv': BLOCK_SIZES_2x2,
                'extra_layer_3_separable_depthwise': BLOCK_SIZES_1x1,
                'extra_layer_3_separable_pointwise': BLOCK_SIZES_1x1,
            }

        self.LAYER_NAME_TO_DIMS = \
            {
                'conv1': [32, 160, 160],
                'layer1_0_0': [32, 160, 160],
                'layer2_0_0': [96, 160, 160],
                'layer2_0_1': [96, 80, 80],
                'layer2_1_0': [144, 80, 80],
                'layer2_1_1': [144, 80, 80],
                'layer3_0_0': [144, 80, 80],
                'layer3_0_1': [144, 40, 40],
                'layer3_1_0': [192, 40, 40],
                'layer3_1_1': [192, 40, 40],
                'layer3_2_0': [192, 40, 40],
                'layer3_2_1': [192, 40, 40],
                'layer4_0_0': [192, 40, 40],
                'layer4_0_1': [192, 20, 20],
                'layer4_1_0': [384, 20, 20],
                'layer4_1_1': [384, 20, 20],
                'layer4_2_0': [384, 20, 20],
                'layer4_2_1': [384, 20, 20],
                'layer4_3_0': [384, 20, 20],
                'layer4_3_1': [384, 20, 20],
                'layer5_0_0': [384, 20, 20],
                'layer5_0_1': [384, 20, 20],
                'layer5_1_0': [576, 20, 20],
                'layer5_1_1': [576, 20, 20],
                'layer5_2_0': [576, 20, 20],
                'layer5_2_1': [576, 20, 20],
                'layer6_0_0': [576, 20, 20],
                'layer6_0_1': [576, 10, 10],
                'layer6_1_0': [960, 10, 10],
                'layer6_1_1': [960, 10, 10],
                'layer6_2_0': [960, 10, 10],
                'layer6_2_1': [960, 10, 10],
                'layer7_0_0': [960, 10, 10],
                'layer7_0_1': [960, 10, 10],
                'conv2': [1280, 10, 10],
                'extra_layer_0_conv': [256, 10, 10],
                'extra_layer_0_separable_depthwise': [256, 5, 5],
                'extra_layer_0_separable_pointwise': [512, 5, 5],
                'extra_layer_1_conv': [128, 5, 5],
                'extra_layer_1_separable_depthwise': [128, 3, 3],
                'extra_layer_1_separable_pointwise': [256, 3, 3],
                'extra_layer_2_conv': [128, 3, 3],
                'extra_layer_2_separable_depthwise': [128, 2, 2],
                'extra_layer_2_separable_pointwise': [256, 2, 2],
                'extra_layer_3_conv': [64, 2, 2],
                'extra_layer_3_separable_depthwise': [64, 1, 1],
                'extra_layer_3_separable_pointwise': [128, 1, 1]
            }
